<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Multi-Language Code Editor</title>
    <script>
        var require = { paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs' } };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif;  padding: 20px; }
        #editor { width: 90%; height: 70vh; margin: auto; border: 1px solid #ccc; }
        select { margin-bottom: 10px; padding: 5px; font-size: 16px; }
        .loading {
            text-align: center;
            font-style: italic;
            color: #bbb;
            display: none;
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <h2>Multi-Language Code Editor</h2>
    <select id="languageSelector">
        <option value="java">Java</option>
        <option value="cpp">C++</option>
        <option value="csharp">C#</option>
    </select>
    <div id="editor"></div>
    <button  onclick="sendMessage(getEditorValue())" id="sendBtn">Execute</button>
    <br>
    <p id="loading" class="loading">Generating response...</p>
    <div id="response" class="response">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum</div>
    <br>
    <script>
        let editor;

        require(["vs/editor/editor.main"], function () {
            editor = monaco.editor.create(document.getElementById("editor"), {
                value: "// Select a language above and start coding...",
                language: "java",
                theme: "vs-dark",
                automaticLayout: true,
                fontSize: 16,
                minimap: { enabled: true }
            });

            document.getElementById("languageSelector").addEventListener("change", function () {
                monaco.editor.setModelLanguage(editor.getModel(), this.value);
            });
        });

        // Function to get editor value
        function getEditorValue() {
            const code = editor.getValue();
            console.log("Editor Value:", code); // Display in console for debugging
            return code;
        }


        //ASKING THE GEMINI
        async function sendMessage(theCode) {
            const userInput = theCode;
            const responseBox = document.getElementById("response");
            const loadingIndicator = document.getElementById("loading");
            const sendButton = document.getElementById("sendBtn");

            if (!userInput.trim()) {
                alert("Please enter a message.");
                return;
            }

            loadingIndicator.style.display = "block";
            sendButton.disabled = true;
            responseBox.innerHTML = "";

            const res = await fetch("gemini.php", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ message: userInput })
            });

            const data = await res.json();
            console.log("API Response:", data);

            loadingIndicator.style.display = "none";
            sendButton.disabled = false;

            if (data.candidates && data.candidates[0].content.parts[0].text) {
                let responseText = data.candidates[0].content.parts[0].text;

                responseBox.innerHTML = responseText;
            } else {
                responseBox.innerHTML = "<span style='color:red;'>Error: No valid response from Gemini API.</span>";
            }
        }
    </script>

</body>
</html>
