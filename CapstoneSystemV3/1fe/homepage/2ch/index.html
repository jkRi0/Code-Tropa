<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Challenge Page</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Monaco Editor script -->
    <script src="../../../../node_modules/monaco-editor/min/vs/loader.js"></script>
</head>
<body>
    <!-- Splash Screen -->
    <div class="splash-screen" id="splashScreen">
        <div class="splash-content">
            <div class="splash-level" id="splashLevel">Loading...</div>
            <div class="splash-difficulty" id="splashDifficulty">Loading...</div>
            <div class="splash-subtitle">Challenge Starting...</div>
        </div>
    </div>
    
    <!-- Verification Panel -->
    <div class="verification-panel" id="verificationPanel">
        <h2>Challenge Selection Verification</h2>
        <div class="verification-info">
            <p><strong>Selected Level:</strong> <span id="selectedLevel">Loading...</span></p>
            <p><strong>Selected Difficulty:</strong> <span id="selectedDifficulty">Loading...</span></p>
            <p><strong>Selected At:</strong> <span id="selectedTime">Loading...</span></p>
        </div>
    </div>
    
    <div class="image-container">
        <button id="backButton" class="back-btn">‚Üê Back</button>
        <img src="" alt="Challenge Image">
        <div class="objectives-container"></div>
        <div class="control-buttons">
            <button id="runCodeBtn" class="control-btn">Run Code</button>
            <button id="submitCodeBtn" class="control-btn">Submit Code</button>
            <button id="showRubricsBtn" class="control-btn">Show Rubrics</button>
            <button id="showTipsBtn" class="control-btn">Show Tips</button>
        </div>
    </div>
    <div class="code-editor-div">
        <div id="monaco-container" style="width: 100%; height: 100%;"></div>
    </div>
    <div class="output-terminal" id="outputTerminal">
        Output/terminal
    </div>

    <!-- Mobile Controls -->
    <div class="mobile-controls">
        <button class="toggle-btn toggle-editor-btn" id="toggleEditor">Editor</button>
        <button class="toggle-btn toggle-terminal-btn" id="toggleTerminal">Terminal</button>
    </div>

    <!-- Rubrics Modal -->
    <div id="rubricsModal" class="rubrics-modal">
        <div class="rubrics-content">
            <span class="close-rubrics">&times;</span>
            <h2>Code Submission Rubrics</h2>
            <div class="rubrics-grid">
                <div class="rubrics-header">
                    <div>Criteria</div>
                    <div>Weight</div>
                    <div>Description</div>
                </div>
                <div class="rubrics-body">
                    <!-- Rubrics rows will be populated by JavaScript -->
                </div>
            </div>
            <div class="total-score">
                <p>Total Possible Score: <span id="totalPossibleScore">100</span></p>
            </div>
        </div>
    </div>

    <!-- Tips Modal -->
    <div id="tipsModal" class="tips-modal">
        <div class="tips-content">
            <span class="close-tips">&times;</span>
            <h2>Challenge Tip</h2>
            <div id="tipQuestion" class="tip-question"></div>
            <div id="tipOptions" class="tip-options"></div>
            <button id="submitAnswerBtn" class="btn-submit-answer">Submit Answer</button>
            <div id="tipFeedback" class="tip-feedback"></div>
            <div id="tipContent" class="tip-content"></div>
        </div>
    </div>

    <!-- External JavaScript Files -->
    <script src="codeAnalyzer.js"></script>
    <script src="monacoEditor.js"></script>
    <script src="challengeData.js"></script>
    <script src="rubrics.js"></script>
    <script src="tips.js"></script>
    <script src="mobileControls.js"></script>
    <script type="module" src="./analysis_grammars/grammarLoader.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            loadSelectedChallengeData();
            const selectedData = JSON.parse(localStorage.getItem('selectedChallenge'));
            if (selectedData && selectedData.level) {
                const levelNumber = selectedData.level.replace('lev', ''); // Extract only the number
                loadLevelScripts(levelNumber);
            }
        });
    </script>
</body>
</html>