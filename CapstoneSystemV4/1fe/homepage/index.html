<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#8B5A2B">
    <meta name="description" content="Code-Tropa - A gamified programming education platform with Filipino culture integration">
    <title>Code-Tropa</title>
    
    <link rel="manifest" href="../../manifest.json">
    <link rel="stylesheet" href="../globalStyles/body.css">
    <link rel="stylesheet" href="styles/styles.css">
    <link rel="stylesheet" href="styles/mobileFirst.css">
    <link rel="stylesheet" href="styles/desktop.css">
    <link rel="icon" type="image/x-icon" href="../assets/favicon.png">
    <link rel="apple-touch-icon" href="../assets/favicon.png">
</head>
<body>
    <div id="portraitDiv" style="display: none;">
        <h2>Rotate your phone for a better experience!</h2>
        <p style="font-size: 3em;">&#x21BA;</p> <!-- Unicode for a rotating arrow -->
    </div>

    <video autoplay loop muted playsinline class="bg-video responsive-bg-image">
        <source src="../assets/bg.mp4" type="video/mp4">
    </video>

    <div class="hamburger-menu">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
    </div>

    <div class="menu-container">
        <aside class="mobile-menu-aside">
            <div class="backblur"></div>
            <!-- SIDE BAR -->
            <div class="outer2" onclick="process(this, 'programmingLanguage')">
                <img src="../assets/arrow-l.png">
                <div class="outer1">
                    <div class="top-border"></div>
                    <div class="inner1">Programming Language</div>
                    <div class="bottom-border"></div>
                </div>
                <img src="../assets/arrow-r.png">
            </div> 

            <div class="outer2" onclick="process(this, 'storyMode')">
                <img src="../assets/arrow-l.png">
                <div class="outer1">
                    <div class="top-border"></div>
                    <div class="inner1">STORY MODE</div>
                    <div class="bottom-border"></div>
                </div>
                <img src="../assets/arrow-r.png">
            </div>  

            <div class="outer2" onclick="process(this, 'challenges')">
                <img src="../assets/arrow-l.png">
                <div class="outer1">
                    <div class="top-border"></div>
                    <div class="inner1">CHALLENGES</div>
                    <div class="bottom-border"></div>
                </div>
                <img src="../assets/arrow-r.png">
            </div>
            
            <div class="outer2" onclick="process(this, 'leaderboard')">
                <img src="../assets/arrow-l.png">
                <div class="outer1">
                    <div class="top-border"></div>
                    <div class="inner1">LEADERBOARD</div>
                    <div class="bottom-border"></div>
                </div>
                <img src="../assets/arrow-r.png">
            </div>

            <div class="outer2" onclick="process(this, 'setting')">
                <img src="../assets/arrow-l.png">
                <div class="outer1">
                    <div class="top-border"></div>
                    <div class="inner1">SETTING</div>
                    <div class="bottom-border"></div>
                </div>
                <img src="../assets/arrow-r.png">
            </div>

            <a href="#" style="text-decoration: none;" id="logout-link">
            <div class="outer2">
                <img src="../assets/arrow-l.png">
                <div class="outer1">
                    <div class="top-border"></div>
                    <div class="inner1" id="logout-text">LOGOUT</div>
                    <div class="bottom-border"></div>
                </div>
                <img src="../assets/arrow-r.png">
            </div>
            </a>
        </aside>
    </div>
    
    <div class="main-content-wrapper">
        <aside class="desktop-menu-aside">
            <div class="backblur"></div>
            <div class="logo">
                <img src="../assets/capstone-logo.png" alt="Code-Tropa Logo">
            </div>
            <!-- SIDE BAR -->
            <div class="outer2" onclick="process(this, 'programmingLanguage')">
                <img src="../assets/arrow-l.png">
                <div class="outer1">
                    <div class="top-border"></div>
                    <div class="inner1">Programming Language</div>
                    <div class="bottom-border"></div>
                </div>
                <img src="../assets/arrow-r.png">
            </div> 

            <div class="outer2" onclick="process(this, 'storyMode')">
                <img src="../assets/arrow-l.png">
                <div class="outer1">
                    <div class="top-border"></div>
                    <div class="inner1">STORY MODE</div>
                    <div class="bottom-border"></div>
                </div>
                <img src="../assets/arrow-r.png">
            </div>  

            <div class="outer2" onclick="process(this, 'challenges')">
                <img src="../assets/arrow-l.png">
                <div class="outer1">
                    <div class="top-border"></div>
                    <div class="inner1">CHALLENGES</div>
                    <div class="bottom-border"></div>
                </div>
                <img src="../assets/arrow-r.png">
            </div>
            
            <div class="outer2" onclick="process(this, 'leaderboard')">
                <img src="../assets/arrow-l.png">
                <div class="outer1">
                    <div class="top-border"></div>
                    <div class="inner1">LEADERBOARD</div>
                    <div class="bottom-border"></div>
                </div>
                <img src="../assets/arrow-r.png">
            </div>

            <div class="outer2" onclick="process(this, 'setting')">
                <img src="../assets/arrow-l.png">
                <div class="outer1">
                    <div class="top-border"></div>
                    <div class="inner1">SETTING</div>
                    <div class="bottom-border"></div>
                </div>
                <img src="../assets/arrow-r.png">
            </div>

            <a href="../logout.php" style="text-decoration: none;" id="desktop-logout-link">
            <div class="outer2">
                <img src="../assets/arrow-l.png">
                <div class="outer1">
                    <div class="top-border"></div>
                    <div class="inner1" id="desktop-logout-text">LOGOUT</div>
                    <div class="bottom-border"></div>
                </div>
                <img src="../assets/arrow-r.png">
            </div></a>
        </aside>
        <div class="logo main-logo">
            <img src="../assets/capstone-logo.png" alt="Code-Tropa Logo">
        </div>
        <main>

            <!-- MODAL FOR PROGRAMMING LANGUAGE SELECTION -->
            <div class="pl-selection-back1">
                <div class="pl-selection">
                    <div class="poly1">
                        <img src="../assets/poly1.png">
                        <p>Select Programming Language</p>
                    </div>
                    
                    <img src="../assets/poly2.png" class="poly2">

                    <div class="outer2-2" onclick="process1(this)">
                        <img src="../assets/arrow-l-b.png">
                        
                        <div class="outer1-2">
                            <div class="top-border-2"></div>
                            <div class="inner1-2-1"></div>
                            <div class="inner1-2">JAVA</div>
                            <div class="bottom-border-2"></div>
                        </div>
                        <img src="../assets/arrow-r-b.png">
                    </div>  

                    <div class="outer2-2" onclick="process1(this)">
                        <img src="../assets/arrow-l-b.png">
                        <div class="outer1-2">
                            <div class="top-border-2"></div>
                            <div class="inner1-2-1"></div>
                            <div class="inner1-2">C++</div>
                            <div class="bottom-border-2"></div>
                        </div>
                        <img src="../assets/arrow-r-b.png">
                    </div>  

                    <div class="outer2-2" onclick="process1(this)">
                        <img src="../assets/arrow-l-b.png">
                        <div class="outer1-2">
                            <div class="top-border-2"></div>
                            <div class="inner1-2-1"></div>
                            <div class="inner1-2">C#</div>
                            <div class="bottom-border-2"></div>
                        </div>
                        <img src="../assets/arrow-r-b.png">
                    </div>  
                    
                    <div class="outer-button">
                        <div class="act-button" onclick="hideModal('back')">Back</div>
                        <div class="act-button" onclick="hideModal('ok')">Ok</div>
                    </div>
                </div>
            </div>


            



            <!-- MODAL FOR STORY MODE -->
            <div class="sm-back1">
                <div class="sm-selection">
                    <div class="poly1-2">
                        <img src="../assets/poly1.png">
                        <p>STORY MODE</p>
                    </div>
                    <button class="back-btn" onclick="hideModal()">BACK</button>
                    <div class="chap-selection-outer">
                        <div class="chap-selection">
                            <div class="outer2-3" onclick="process2(this,'chap1')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Chapter I</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process2(this,'chap2')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Chapter II</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process2(this,'chap3')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Chapter III</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                        </div>

                        <!-- CHAPTER 1 EPISODE SELECTION -->
                        <div class="forScroll">
                            <div class="epi-selection chap1">
                                <div class="epi-option">
                                    <div class="epi-title">
                                        <h2>Episode 1</h2>
                                    </div>
                                    <div class="epi-desc">
                                        <p>Basic Syntax, Code Structure, and Comments</p>
                                    </div>
                                    <button onclick="redirectToEpisode('ep1')">Play</button>
                                </div>
                                
                                <div class="epi-option">
                                    <div class="epi-title">
                                        <h2>Episode 2</h2>
                                    </div>
                                    <div class="epi-desc">
                                        <p>Variables and Data Types</p>
                                    </div>
                                    <button onclick="redirectToEpisode('ep2')">Play</button>
                                </div>
    
                                <div class="epi-option">
                                    <div class="epi-title">
                                        <h2>Episode 3</h2>
                                    </div>
                                    <div class="epi-desc">
                                        <p>Operators and Expressions</p>
                                    </div>
                                    <button onclick="redirectToEpisode('ep3')">Play</button>
                                </div>
                            </div>
    
                            <!-- CHAPTER 2 EPISODE SELECTION -->
                            <div class="epi-selection chap2">
                                <div class="epi-option">
                                    <div class="epi-title">
                                        <h2>Episode 1</h2>
                                    </div>
                                    <div class="epi-desc">
                                        <p>Control Flow (if-else, switch, and loops)</p>
                                    </div>
                                    <button onclick="redirectToEpisode('ep4')">Play</button>
                                </div>
                                
                                <div class="epi-option">
                                    <div class="epi-title">
                                        <h2>Episode 2</h2>
                                    </div>
                                    <div class="epi-desc">
                                        <p>String Operations</p>
                                    </div>
                                    <button onclick="redirectToEpisode('ep5')">Play</button>
                                </div>
                            </div>
    
                            <!-- CHAPTER 3 EPISODE SELECTION -->
                            <div class="epi-selection chap3">
                                <div class="epi-option">
                                    <div class="epi-title">
                                        <h2>Episode 1</h2>
                                    </div>
                                    <div class="epi-desc">
                                        <p>Arrays</p>
                                    </div>
                                    <button onclick="redirectToEpisode('ep6')">Play</button>
                                </div>
                                
                                <div class="epi-option">
                                    <div class="epi-title">
                                        <h2>Episode 2</h2>
                                    </div>
                                    <div class="epi-desc">
                                        <p>Methods / Functions</p>
                                    </div>
                                    <button onclick="redirectToEpisode('ep7')">Play</button>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>
            




            <!-- MODAL FOR CHALLENGES -->
            <div class="ch-back1">
                <div class="sm-selection">
                    <div class="poly1-2">
                        <img src="../assets/poly1.png">
                        <p>CHALLENGES</p>
                    </div>
                    <button class="back-btn" onclick="hideModal()">BACK</button>
                    <div class="chap-selection-outer">
                        <div class="chap-selection">
                            <div class="outer2-3" onclick="process3(this,'lev1')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 1</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev2')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 2</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev3')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 3</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev4')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 4</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev5')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 5</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev6')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 6</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev7')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 7</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev8')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 8</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev9')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 9</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev10')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 10</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev11')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 11</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev12')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 12</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev13')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 13</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev14')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 14</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev15')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 15</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev16')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 16</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev17')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 17</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev18')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 18</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev19')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 19</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process3(this,'lev20')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Level 20</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                        </div>

                        <!-- LEVEL DESCRIPTION -->
                        <div class="epi-selection lev1">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/1/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Taho Time!</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Basic Syntax
                                        <br>Filipino Cultural Context: Morning taho vendor making daily rounds.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev2">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/2/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Sari-Sari Store Inventory</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Variables and Data Types
                                        <br>Filipino Cultural Context: Managing inventory in a small community sari-sari store.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev3">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/3/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Fiesta Budget Planner</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Operators and Expressions
                                        <br> Planning expenses for an upcoming barangay fiesta.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev4">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/4/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Barangay Curfew Check</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Control Flow
                                        <br>Filipino Cultural Context: Barangay tanod enforcing curfew at night.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev5">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/5/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Bayanihan Scheduler</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Methods / Functions
                                        <br>Filipino Cultural Context: Organizing community help for house relocation.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev6">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/6/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Jeepney Fare Calculator</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Arrays
                                        <br>Filipino Cultural Context: Estimating jeepney fares for common routes.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev7">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/7/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Pamamanhikan</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Methods / Functions
                                        <br>Filipino Cultural Context: Coordinating a traditional marriage proposal visit.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev8">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/8/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Tikbalang Path</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Control Flow
                                        <br>Filipino Cultural Context:Escaping from a mythical Tikbalang in an enchanted forest.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev9">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/9/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Fiesta Poster Maker</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: String Operations
                                        <br>Filipino Cultural Context: Designing a town festival promotional poster.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev10">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/10/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Larong Kalye Leaderboard</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Arrays
                                        <br>Filipino Cultural Context: Tracking scores in street games like Tumbang Preso.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev11">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/11/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Barangay Population Analyzer</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Arrays + Expressions
                                        <br>Filipino Cultural Context: Analyzing population data from household surveys.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev12">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/12/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Simbang Gabi</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Strings + Conditions
                                        <br>Filipino Cultural Context: Logging attendance during 9-day dawn masses.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev13">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/13/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Filipino Family Menu</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Arrays + Functions
                                        <br>Filipino Cultural Context: Preparing meals for a Filipino family gathering.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev14">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/14/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Filipino Names Analyzer</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Strings + Sorting
                                        <br>Filipino Cultural Context: Analyzing common Filipino first names.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev15">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/15/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Tricycle Dispatch</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Arrays + Control Flow + Functions
                                        <br>Filipino Cultural Context: Assigning drivers and passengers to tricycle routes.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev16">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/16/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Albularyo Potion Log</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Arrays + Functions
                                        <br>Filipino Cultural Context: Logging potion recipes of a traditional healer.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev17">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/17/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Palarong Barangay Medal Tally</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Arrays + Sorting
                                        <br>Filipino Cultural Context: Tallying sports medals during a local competition.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev18">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/18/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Miss Barangay Scoring System</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Arrays + Functions
                                        <br>Filipino Cultural Context: Tabulating scores for a local beauty pageant.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev19">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/19/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Aswang Alert</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Arrays + Conditions
                                        <br>Filipino Cultural Context: Monitoring barangay reports of mythical creature sightings.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>
                        <div class="epi-selection lev20">
                            <div class="epi-option">
                                <picture>
                                    <source srcset="../assets/samplebg-small.jpg" media="(max-width: 600px)">
                                    <img src="./2ch/assets/20/EASY.png" alt="Episode Background" class="responsive-episode-image">
                                </picture>
                                <div class="epi-title">
                                    <h2>Jeepney Fare Matrix Calculator</h2>
                                </div>
                                <div class="epi-desc">
                                    <p>Topic: Arrays + Functions + Loops
                                        <br>Filipino Cultural Context: Computing public jeepney fares for various routes.
                                    </p>
                                </div>
                                <button onclick="difActions('play')">Play</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            
            <!-- MODAL FOR DIFFICULTY SELECTION -->
            <div class="dif-selection-back1">
                <div class="pl-selection">
                    <div class="poly1">
                        <img src="../assets/poly1.png">
                        <p>Select Difficulty</p>
                    </div>
                    
                    <img src="../assets/poly2.png" class="poly2">

                    <div class="outer2-2" onclick="selectDifficulty(this)">
                        <img src="../assets/arrow-l-b.png">
                        <div class="outer1-2">
                            <div class="top-border-2"></div>
                            <div class="inner1-2-1"></div>
                            <div class="inner1-2">EASY</div>
                            <div class="bottom-border-2"></div>
                        </div>
                        <img src="../assets/arrow-r-b.png">
                    </div>  

                    <div class="outer2-2" onclick="selectDifficulty(this)">
                        <img src="../assets/arrow-l-b.png">
                        <div class="outer1-2">
                            <div class="top-border-2"></div>
                            <div class="inner1-2-1"></div>
                            <div class="inner1-2">AVERAGE</div>
                            <div class="bottom-border-2"></div>
                        </div>
                        <img src="../assets/arrow-r-b.png">
                    </div>  

                    <div class="outer2-2" onclick="selectDifficulty(this)">
                        <img src="../assets/arrow-l-b.png">
                        <div class="outer1-2">
                            <div class="top-border-2"></div>
                            <div class="inner1-2-1"></div>
                            <div class="inner1-2">DIFFICULT</div>
                            <div class="bottom-border-2"></div>
                        </div>
                        <img src="../assets/arrow-r-b.png">
                    </div>  
                    
                    <!-- <p id="difficultyErrorMessage" class="error-message"></p> -->

                    <div class="outer-button">
                        <div class="act-button" onclick="difActions('back')">Back</div>
                        <div class="act-button" onclick="difActions('ok')">Ok</div>
                    </div>
                </div>
            </div>





            <!-- MODAL FOR LEADERBOARD -->
            <div class="lb-back1">
                <div class="sm-selection lb-selection">
                    <div class="poly1-2">
                        <img src="../assets/poly1.png">
                        <p>LEADERBOARD</p>
                    </div>
                    <button class="back-btn" onclick="hideModal()">BACK</button>
                    
                    <!-- Language Filter Section -->
                    <div class="language-filter-section">
                        <h3>Show Points Earned In:</h3>
                        <div class="language-filter-buttons">
                            <button class="language-filter-btn active" data-language="all">All Languages</button>
                            <button class="language-filter-btn" data-language="java">Java Points</button>
                            <button class="language-filter-btn" data-language="c++">C++ Points</button>
                            <button class="language-filter-btn" data-language="c#">C# Points</button>
                        </div>
                    </div>

                    <!-- Leaderboard Section -->
                    <div class="leaderboard-section">
                        <div class="leaderboard-header">
                            <div class="header-item">Rank</div>
                            <div class="header-item">Player Name</div>
                            <div class="header-item">Tier Level</div>
                            <div class="header-item">Total Points</div>
                        </div>
                        <div class="leaderboard-content">
                            <!-- Leaderboard data will be dynamically loaded here -->
                        </div>
                    </div>
                </div>
            </div>





            <!-- MODAL FOR SETTING -->
            <div class="se-back1">
                <div class="sm-selection se-selection">
                    <div class="poly1-2">
                        <img src="../assets/poly1.png">
                        <p>SETTINGS</p>
                    </div>
                    <button class="back-btn" onclick="hideModal()">BACK</button>
                    <div class="chap-selection-outer">
                        <div class="chap-selection">
                            <div class="outer2-3" onclick="process2(this,'profile')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Profile</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3 mobile-hide-controls-modal-item" onclick="process2(this,'controls')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Controls</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                            <div class="outer2-3" onclick="process2(this,'volume')">
                                <img src="../assets/arrow-l-b.png">
                                <div class="outer1-3">
                                    <div class="top-border-3"></div>
                                    <div class="inner1-3">Volume</div>
                                    <div class="bottom-border-3"></div>
                                </div>
                                <img src="../assets/arrow-r-b.png">
                            </div>
                        </div>

                        
                        <div class="epi-selection profile">
                            <div class="profile-info">
                                <p><strong>Player Name:</strong> <span id="playerName">Loading...</span></p>
                                <p><strong>Current Points:</strong> <span id="currentPoints">Loading...</span></p>
                                <p><strong>Current Tier Level:</strong> <span id="currentTier">Loading...</span></p>
                            </div>
                            <div class="profile-badges">
                                <h3>Badges Achieved:</h3>
                                <div class="badges-container">
                                </div>
                            </div>
                            <div class="profile-performance">
                                <h3>Overall Performance Insights:</h3>
                                <div class="bar-graph-container">
                                    <div class="bar-wrapper">
                                        <div class="bar bar-accuracy"><span class="bar-percentage-label">%</span></div>
                                    </div>
                                    <div class="bar-wrapper">
                                        <div class="bar bar-efficiency"><span class="bar-percentage-label">%</span></div>
                                    </div>
                                    <div class="bar-wrapper">
                                        <div class="bar bar-readability"><span class="bar-percentage-label">%</span></div>
                                    </div>
                                    <div class="bar-wrapper">
                                        <div class="bar bar-time"><span class="bar-percentage-label">%</span></div>
                                    </div>
                                </div>
                                <div class="chart-legends">
                                    <p><span class="legend-color legend-color-accuracy"></span> Accuracy</p>
                                    <p><span class="legend-color legend-color-efficiency"></span> Efficiency</p>
                                    <p><span class="legend-color legend-color-readability"></span> Readability</p>
                                    <p><span class="legend-color legend-color-time"></span> Time</p>
                                </div>
                            </div>
                            <div class="profile-actions">
                                <button class="view-recommendations-btn" onclick="showRecommendationsModal()">View Code Performance Recommendations</button>
                                <button class="edit-account-btn">Edit Account</button>
                                <button class="delete-account-btn">Delete Account</button>
                            </div>
                        </div>

                        <div class="epi-selection controls">
                            <h3>Game Controls</h3>
                            <div class="control-setting">
                                <p><strong>Move Up:</strong></p>
                                <span class="control-key" id="moveUpKey">W</span>
                                <button class="edit-control-btn" data-control="moveUp">Edit</button>
                            </div>
                            <div class="control-setting">
                                <p><strong>Move Left:</strong></p>
                                <span class="control-key" id="moveLeftKey">A</span>
                                <button class="edit-control-btn" data-control="moveLeft">Edit</button>
                            </div>
                            <div class="control-setting">
                                <p><strong>Move Down:</strong></p>
                                <span class="control-key" id="moveDownKey">S</span>
                                <button class="edit-control-btn" data-control="moveDown">Edit</button>
                            </div>
                            <div class="control-setting">
                                <p><strong>Move Right:</strong></p>
                                <span class="control-key" id="moveRightKey">D</span>
                                <button class="edit-control-btn" data-control="moveRight">Edit</button>
                            </div>
                            <div class="control-setting">
                                <p><strong>Skip/Next:</strong></p>
                                <span class="control-key" id="skipNextControl">Click / Touch</span>
                                <button class="edit-control-btn" data-control="skipNext">Edit</button>
                            </div>
                        </div>

                        <div class="epi-selection volume">
                            <h3>Volume Settings</h3>
                            <div class="volume-setting">
                                <p><strong>Background Music:</strong></p>
                                <input type="range" id="bgMusicVolume" min="0" max="100" value="50" class="volume-slider">
                                <span id="bgMusicValue">50%</span>
                            </div>
                            <div class="volume-setting">
                                <p><strong>Sound Effects:</strong></p>
                                <input type="range" id="sfxVolume" min="0" max="100" value="75" class="volume-slider">
                                <span id="sfxValue">75%</span>
                            </div>
                        </div>

                        
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Edit Account Modal -->
    <div id="editAccountModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Edit Account</h2>
            <form id="editAccountForm">
                <label for="editUsername">Username:</label>
                <input type="text" id="editUsername" name="username">
                <label for="editCurrentPassword">Current Password:</label>
                <input type="password" id="editCurrentPassword" name="current_password">
                <label for="editNewPassword">New Password:</label>
                <input type="password" id="editNewPassword" name="new_password">
                <label for="editConfirmNewPassword">Confirm New Password:</label>
                <input type="password" id="editConfirmNewPassword" name="confirm_new_password">
                <button type="submit">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- Delete Account Modal -->
    <div id="deleteAccountModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Delete Account</h2>
            <p>Are you sure you want to delete your account? This action cannot be undone.</p>
            <button id="confirmDeleteBtn">Delete My Account</button>
            <button class="cancel-delete-btn">Cancel</button>
        </div>
    </div>

    <audio id="homepageBackgroundMusic" src="../assets/bgMusic.mp3" loop preload="auto" volume="0.5"></audio>

    <!-- Bottom-right Info Container -->
    <div class="bottom-right-info-container">
        <div class="info-content">
            <p class="welcome-text">Welcome, <span id="playerNameDisplay">Player</span>!</p>
            <p class="language-text">Programming Language: <span id="currentLanguageDisplay">Not Selected</span></p>
            <button class="post-test-btn" onclick="redirectToPostTest()">Take Post-Test</button>
            <button class="view-progress-btn" onclick="showProgressModal()">View Progress</button>
            <!-- <button class="new-tab-btn" onclick="openNewTab()">AnswerKey</button> -->
        </div>
    </div>

    <!-- Progress Modal -->
    <div class="progress-modal-back" id="progressModal">
        <div class="progress-modal-content">
            <div class="progress-modal-header">
                <h2 id="progressModalTitle">Story Mode Progress</h2>
                <button class="progress-modal-close" onclick="hideProgressModal()">&times;</button>
            </div>
            <div class="progress-modal-body">
                <div class="progress-mode-toggle">
                    <button class="mode-toggle-btn active" data-mode="story" onclick="switchProgressMode('story')">Story Mode</button>
                    <button class="mode-toggle-btn" data-mode="challenge" onclick="switchProgressMode('challenge')">Challenges</button>
                </div>
                <div class="progress-items-container" id="progressItemsContainer">
                    <!-- Progress items will be dynamically generated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Recommendations Modal -->
    <div class="recommendations-modal-back" id="recommendationsModal">
        <div class="recommendations-modal-content">
            <div class="recommendations-modal-header">
                <h2>Personalized Code Performance Recommendations</h2>
                <button class="recommendations-modal-close" onclick="hideRecommendationsModal()">&times;</button>
            </div>
            <div class="recommendations-modal-body">
                <div class="recommendations-container" id="recommendationsContainer">
                    <p class="loading-recommendations">Analyzing your coding performance...</p>
                </div>
            </div>
        </div>
    </div>

    <style>
        .bottom-right-info-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, rgba(139, 90, 43, 0.95), rgba(101, 67, 33, 0.95));
            border: 2px solid #d4a574;
            border-radius: 10px;
            padding: 15px 20px;
            box-shadow: 0 4px 15px rgba(139, 90, 43, 0.4);
            z-index: 999;
            backdrop-filter: blur(10px);
            min-width: 250px;
        }

        .info-content {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .welcome-text,
        .language-text {
            color: #f5e6d3;
            font-size: 1.5rem;
            margin: 0;
            font-family: Arial, sans-serif;
        }

        .welcome-text span,
        .language-text span {
            color: #f4d4a0;
            font-weight: bold;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .post-test-btn {
            background: linear-gradient(135deg, #c89d5c, #a3692f);
            color: #f4d4a0;
            border: 2px solid #d4a574;
            padding: 10px 15px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 2rem;
            margin-top: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .post-test-btn:hover {
            transform: scale(1.05);
            background: linear-gradient(135deg, #d4a574, #c89d5c);
            box-shadow: 0 4px 10px rgba(212, 165, 116, 0.6);
        }

        .post-test-btn:active {
            transform: scale(0.98);
        }

        .view-progress-btn {
            background: linear-gradient(135deg, #c89d5c, #a3692f);
            color: #f4d4a0;
            border: 2px solid #d4a574;
            padding: 10px 15px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 2rem;
            margin-top: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .view-progress-btn:hover {
            transform: scale(1.05);
            background: linear-gradient(135deg, #d4a574, #c89d5c);
            box-shadow: 0 4px 10px rgba(212, 165, 116, 0.6);
        }

        .view-progress-btn:active {
            transform: scale(0.98);
        }

        /* Profile Recommendations Styles */
        .profile-recommendations {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, rgba(30, 30, 30, 0.95), rgba(20, 20, 20, 0.95));
            border: 2px solid #d4a574;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(139, 90, 43, 0.4);
        }

        .profile-recommendations h3 {
            color: #f4d4a0;
            font-size: 2.2rem;
            margin-bottom: 25px;
            text-align: center;
            font-family: Arial, sans-serif;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            border-bottom: 2px solid #d4a574;
            padding-bottom: 15px;
        }

        .recommendations-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-height: 600px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .recommendations-container::-webkit-scrollbar {
            width: 8px;
        }

        .recommendations-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }

        .recommendations-container::-webkit-scrollbar-thumb {
            background: #d4a574;
            border-radius: 4px;
        }

        .recommendation-item {
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid;
            background: rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .recommendation-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }

        .recommendation-item.priority-high {
            border-left-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.15);
        }

        .recommendation-item.priority-medium {
            border-left-color: #ffa94d;
            background: rgba(255, 169, 77, 0.15);
        }

        .recommendation-item.priority-low {
            border-left-color: #51cf66;
            background: rgba(81, 207, 102, 0.15);
        }

        .recommendation-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .recommendation-category {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            background: rgba(212, 165, 116, 0.3);
            color: #f4d4a0;
        }

        .recommendation-title {
            color: #f5e6d3;
            font-size: 1.8rem;
            margin: 0;
            flex: 1;
            font-family: Arial, sans-serif;
            font-weight: bold;
        }

        .recommendation-priority {
            padding: 5px 14px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .recommendation-priority.priority-high {
            background: #ff6b6b;
            color: #fff;
        }

        .recommendation-priority.priority-medium {
            background: #ffa94d;
            color: #fff;
        }

        .recommendation-priority.priority-low {
            background: #51cf66;
            color: #fff;
        }

        .recommendation-description {
            color: #e9ecef;
            font-size: 1.4rem;
            line-height: 1.6;
            margin-bottom: 15px;
            font-family: Arial, sans-serif;
        }

        .recommendation-section {
            margin-top: 15px;
        }

        .recommendation-section-title {
            color: #d4a574;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: Arial, sans-serif;
        }

        .recommendation-section-title::before {
            content: '';
            font-size: 1.8rem;
        }

        .recommendation-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .recommendation-list li {
            color: #e9ecef;
            font-size: 1.3rem;
            line-height: 1.8;
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            font-family: Arial, sans-serif;
        }

        .recommendation-list li::before {
            content: '';
            position: absolute;
            left: 0;
            color: #d4a574;
            font-weight: bold;
        }

        .recommendation-list.exercises li::before {
            content: '';
        }

        .recommendation-list.hints li::before {
            content: '';
        }

        .recommendation-list.study li::before {
            content: '';
        }

        .loading-recommendations,
        .no-recommendations,
        .error-recommendations {
            color: #f5e6d3;
            font-size: 1.6rem;
            text-align: center;
            padding: 30px;
            font-style: italic;
        }

        .error-recommendations {
            color: #ff6b6b;
        }

        /* Responsive adjustments for recommendations */
        @media (max-width: 768px) {
            .profile-recommendations {
                padding: 15px;
                margin-top: 20px;
            }

            .profile-recommendations h3 {
                font-size: 1.8rem;
            }

            .recommendation-item {
                padding: 15px;
            }

            .recommendation-title {
                font-size: 1.5rem;
            }

            .recommendation-description {
                font-size: 1.2rem;
            }

            .recommendation-list li {
                font-size: 1.1rem;
            }

            .recommendation-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .recommendation-priority {
                align-self: flex-start;
            }
        }

        .new-tab-btn {
            background: linear-gradient(135deg, #c89d5c, #a3692f);
            color: #f4d4a0;
            border: 2px solid #d4a574;
            padding: 10px 15px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 2rem;
            margin-top: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .new-tab-btn:hover {
            transform: scale(1.05);
            background: linear-gradient(135deg, #d4a574, #c89d5c);
            box-shadow: 0 4px 10px rgba(212, 165, 116, 0.6);
        }

        .new-tab-btn:active {
            transform: scale(0.98);
        }

        /* Responsive adjustments for mobile */
        @media (max-width: 768px) {
            .bottom-right-info-container {
                bottom: 10px;
                right: 10px;
                padding: 12px 15px;
                min-width: 200px;
            }

            .welcome-text,
            .language-text {
                font-size: 12px;
            }

            .post-test-btn,
            .new-tab-btn,
            .view-progress-btn {
                padding: 8px 12px;
                font-size: 12px;
            }
        }

        /* Progress Modal Styles */
        .progress-modal-back {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }

        .progress-modal-back.show {
            display: flex;
        }

        .progress-modal-content {
            background: linear-gradient(135deg, rgba(20, 20, 20, 0.98), rgba(30, 30, 30, 0.98));
            border: 2px solid #d4a574;
            border-radius: 15px;
            width: 90%;
            max-width: 900px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }

        .progress-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 2px solid #d4a574;
        }

        .progress-modal-header h2 {
            color: #f5e6d3;
            font-size: 2.5rem;
            margin: 0;
            font-family: Arial, sans-serif;
        }

        .progress-modal-close {
            background: transparent;
            border: 1px solid #d4a574;
            color: #f5e6d3;
            font-size: 3rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            line-height: 1;
        }

        .progress-modal-close:hover {
            background: rgba(212, 165, 116, 0.2);
            transform: rotate(90deg);
        }

        .progress-modal-body {
            padding: 30px;
            overflow-y: auto;
            flex: 1;
        }

        .progress-mode-toggle {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .mode-toggle-btn {
            background: rgba(139, 90, 43, 0.6);
            border: 2px solid #8b5a2b;
            color: #f5e6d3;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 1.6rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mode-toggle-btn:hover {
            background: rgba(212, 165, 116, 0.8);
            border-color: #d4a574;
        }

        .mode-toggle-btn.active {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            border-color: #2E7D32;
        }

        .progress-items-container {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
        }

        .progress-item {
            position: relative;
            min-width: 60px;
            height: 60px;
            background: rgba(139, 90, 43, 0.6);
            border: 2px solid #8b5a2b;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #f5e6d3;
            font-size: 1.4rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .progress-item:hover {
            background: rgba(212, 165, 116, 0.8);
            border-color: #d4a574;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(212, 165, 116, 0.4);
        }

        .progress-item.completed {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            border-color: #2E7D32;
        }

        .progress-item.completed:hover {
            background: linear-gradient(135deg, #45a049, #4CAF50);
            border-color: #2E7D32;
        }

        .progress-item.locked {
            background: rgba(100, 100, 100, 0.4);
            border-color: #666;
            opacity: 0.5;
            cursor: not-allowed;
        }

        .progress-item.locked:hover {
            transform: none;
            box-shadow: none;
        }

        /* Tooltip Styles */
        .progress-item-tooltip {
            position: absolute;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(20, 20, 20, 0.98);
            color: #f5e6d3;
            padding: 15px 20px;
            border-radius: 10px;
            border: 2px solid #d4a574;
            font-size: 1.4rem;
            white-space: nowrap;
            z-index: 10001;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5);
            max-width: 350px;
            white-space: normal;
            text-align: center;
        }

        .progress-item:hover .progress-item-tooltip {
            opacity: 1;
            pointer-events: auto;
        }

        .progress-item-tooltip::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid #d4a574;
        }

        .progress-item-tooltip-title {
            font-weight: bold;
            margin-bottom: 6px;
            color: #f4d4a0;
            font-size: 1.5rem;
        }

        .progress-item-tooltip-topic {
            font-size: 1.2rem;
            color: #f5e6d3;
        }

        /* Responsive adjustments for progress modal */
        @media (max-width: 768px) {
            .progress-modal-content {
                width: 95%;
                max-height: 90vh;
            }

            .progress-modal-header h2 {
                font-size: 1.8rem;
            }

            .progress-item {
                min-width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }

            .mode-toggle-btn {
                padding: 10px 20px;
                font-size: 1.3rem;
            }

            .progress-item-tooltip {
                font-size: 1.2rem;
                padding: 12px 16px;
                max-width: 280px;
            }

            .progress-item-tooltip-title {
                font-size: 1.3rem;
            }

            .progress-item-tooltip-topic {
                font-size: 1.1rem;
            }
        }

        /* Recommendations Button Styles */
        .view-recommendations-btn {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: #f4d4a0;
            border: 2px solid #5aa3f0;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.6rem;
            margin: 10px 0;
            box-shadow: 0 3px 8px rgba(74, 144, 226, 0.4);
            width: 100%;
        }

        .view-recommendations-btn:hover {
            transform: scale(1.02);
            background: linear-gradient(135deg, #5aa3f0, #4a90e2);
            box-shadow: 0 5px 15px rgba(90, 163, 240, 0.6);
        }

        .view-recommendations-btn:active {
            transform: scale(0.98);
        }

        /* Recommendations Modal Styles */
        .recommendations-modal-back {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            backdrop-filter: blur(5px);
        }

        .recommendations-modal-back.show {
            display: flex;
        }

        .recommendations-modal-content {
            background: linear-gradient(135deg, rgba(20, 20, 20, 0.98), rgba(30, 30, 30, 0.98));
            border: 2px solid #4a90e2;
            border-radius: 15px;
            width: 90%;
            max-width: 1000px;
            max-height: 85vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }

        .recommendations-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 2px solid #4a90e2;
        }

        .recommendations-modal-header h2 {
            color: #f5e6d3;
            font-size: 2.5rem;
            margin: 0;
            font-family: Arial, sans-serif;
        }

        .recommendations-modal-close {
            background: transparent;
            border: 1px solid #4a90e2;
            color: #f5e6d3;
            font-size: 3rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            line-height: 1;
        }

        .recommendations-modal-close:hover {
            background: rgba(74, 144, 226, 0.2);
            transform: rotate(90deg);
        }

        .recommendations-modal-body {
            padding: 30px;
            overflow-y: auto;
            flex: 1;
        }

        /* Profile Recommendations Styles (now inside modal) */
        .recommendations-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .recommendation-item {
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid;
            background: rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .recommendation-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }

        .recommendation-item.priority-high {
            border-left-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.15);
        }

        .recommendation-item.priority-medium {
            border-left-color: #ffa94d;
            background: rgba(255, 169, 77, 0.15);
        }

        .recommendation-item.priority-low {
            border-left-color: #51cf66;
            background: rgba(81, 207, 102, 0.15);
        }

        .recommendation-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .recommendation-category {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            background: rgba(74, 144, 226, 0.3);
            color: #f4d4a0;
        }

        .recommendation-title {
            color: #f5e6d3;
            font-size: 1.8rem;
            margin: 0;
            flex: 1;
            font-family: Arial, sans-serif;
            font-weight: bold;
        }

        .recommendation-priority {
            padding: 5px 14px;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .recommendation-priority.priority-high {
            background: #ff6b6b;
            color: #fff;
        }

        .recommendation-priority.priority-medium {
            background: #ffa94d;
            color: #fff;
        }

        .recommendation-priority.priority-low {
            background: #51cf66;
            color: #fff;
        }

        .recommendation-description {
            color: #e9ecef;
            font-size: 1.4rem;
            line-height: 1.6;
            margin-bottom: 15px;
            font-family: Arial, sans-serif;
        }

        .recommendation-section {
            margin-top: 15px;
        }

        .recommendation-section-title {
            color: #5aa3f0;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: Arial, sans-serif;
        }

        .recommendation-section-title::before {
            content: '';
            font-size: 1.8rem;
        }

        .recommendation-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .recommendation-list li {
            color: #e9ecef;
            font-size: 1.3rem;
            line-height: 1.8;
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            font-family: Arial, sans-serif;
        }

        .recommendation-list li::before {
            content: '';
            position: absolute;
            left: 0;
            color: #5aa3f0;
            font-weight: bold;
        }

        .recommendation-list.exercises li::before {
            content: '';
        }

        .recommendation-list.hints li::before {
            content: '';
        }

        .recommendation-list.study li::before {
            content: '';
        }

        .loading-recommendations,
        .no-recommendations,
        .error-recommendations {
            color: #f5e6d3;
            font-size: 1.6rem;
            text-align: center;
            padding: 30px;
            font-style: italic;
        }

        .error-recommendations {
            color: #ff6b6b;
        }

        /* Responsive adjustments for recommendations modal */
        @media (max-width: 768px) {
            .recommendations-modal-content {
                width: 95%;
                max-height: 90vh;
            }

            .recommendations-modal-header h2 {
                font-size: 1.8rem;
            }

            .recommendation-item {
                padding: 15px;
            }

            .recommendation-title {
                font-size: 1.5rem;
            }

            .recommendation-description {
                font-size: 1.2rem;
            }

            .recommendation-list li {
                font-size: 1.1rem;
            }

            .recommendation-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .recommendation-priority {
                align-self: flex-start;
            }

            .view-recommendations-btn {
                font-size: 1.3rem;
                padding: 10px 15px;
            }
        }
    </style>

    <script>
        // Function to redirect to post-test page
        function redirectToPostTest() {
            // Check if user has completed all episodes before allowing post-test
            window.location.href = '../asmt/posttest.html';
        }

        // Function to open new tab
        function openNewTab() {
            window.open('newtab.html', '_blank');
        }

        // Progress Modal Functions
        function showProgressModal() {
            const modal = document.getElementById('progressModal');
            if (modal) {
                modal.classList.add('show');
                // Initialize progress bar with current mode
                if (window.initProgressBar) {
                    window.initProgressBar();
                }
            }
        }

        function hideProgressModal() {
            const modal = document.getElementById('progressModal');
            if (modal) {
                modal.classList.remove('show');
            }
        }

        // Recommendations Modal Functions
        function showRecommendationsModal() {
            const modal = document.getElementById('recommendationsModal');
            if (modal) {
                modal.classList.add('show');
                // Load recommendations when modal is opened
                loadCodingRecommendations();
            }
        }

        function hideRecommendationsModal() {
            const modal = document.getElementById('recommendationsModal');
            if (modal) {
                modal.classList.remove('show');
            }
        }

        function switchProgressMode(mode) {
            // Update toggle buttons
            document.querySelectorAll('.mode-toggle-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.mode === mode) {
                    btn.classList.add('active');
                }
            });

            // Update title
            const title = document.getElementById('progressModalTitle');
            if (title) {
                title.textContent = mode === 'story' ? 'Story Mode Progress' : 'Challenge Mode Progress';
            }

            // Update progress bar
            if (window.switchProgressMode) {
                window.switchProgressMode(mode);
            }
        }

        // Close modal when clicking outside
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('progressModal');
            if (modal && e.target === modal) {
                hideProgressModal();
            }
        });

        // Update player name from session/local storage or profile data
        function updatePlayerInfo() {
            const playerNameElement = document.getElementById('playerNameDisplay');
            const languageElement = document.getElementById('currentLanguageDisplay');
            
            // Get player name from existing profile data if available
            const playerNameFromProfile = document.getElementById('playerName');
            if (playerNameFromProfile && playerNameFromProfile.textContent !== 'Loading...') {
                playerNameElement.textContent = playerNameFromProfile.textContent;
            }
            
            // Get selected language from localStorage
            const selectedLanguage = localStorage.getItem('selectedLanguage');
            if (selectedLanguage) {
                languageElement.textContent = selectedLanguage.toUpperCase();
            } else {
                // If not in localStorage, show "Not Selected"
                languageElement.textContent = 'Not Selected';
            }
        }

        // Update info on page load
        document.addEventListener('DOMContentLoaded', () => {
            updatePlayerInfo();
        });
        
        // Update info periodically to catch changes
        setInterval(updatePlayerInfo, 2000);

        // Load and display coding recommendations
        function loadCodingRecommendations() {
            const container = document.getElementById('recommendationsContainer');
            if (!container) return;

            fetch('../../2be/get_coding_recommendations.php')
                .then(response => response.json())
                .then(data => {
                    if (data.success && data.recommendations && data.recommendations.length > 0) {
                        displayRecommendations(data.recommendations);
                    } else {
                        container.innerHTML = '<p class="no-recommendations">Complete some challenges to get personalized recommendations based on your coding performance!</p>';
                    }
                })
                .catch(error => {
                    console.error('Error loading recommendations:', error);
                    container.innerHTML = '<p class="error-recommendations">Unable to load recommendations. Please try again later.</p>';
                });
        }

        function displayRecommendations(recommendations) {
            const container = document.getElementById('recommendationsContainer');
            if (!container) return;

            container.innerHTML = recommendations.map(rec => `
                <div class="recommendation-item priority-${rec.priority}">
                    <div class="recommendation-header">
                        <span class="recommendation-category">${rec.category}</span>
                        <h4 class="recommendation-title">${rec.title}</h4>
                        <span class="recommendation-priority priority-${rec.priority}">${rec.priority.toUpperCase()}</span>
                    </div>
                    <p class="recommendation-description">${rec.description}</p>
                    
                    ${rec.exercises && rec.exercises.length > 0 ? `
                        <div class="recommendation-section">
                            <div class="recommendation-section-title">Exercises</div>
                            <ul class="recommendation-list exercises">
                                ${rec.exercises.map(ex => `<li>${ex}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                    
                    ${rec.hints && rec.hints.length > 0 ? `
                        <div class="recommendation-section">
                            <div class="recommendation-section-title">Hints & Tips</div>
                            <ul class="recommendation-list hints">
                                ${rec.hints.map(hint => `<li>${hint}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                    
                    ${rec.studyMaterials && rec.studyMaterials.length > 0 ? `
                        <div class="recommendation-section">
                            <div class="recommendation-section-title">Study Materials</div>
                            <ul class="recommendation-list study">
                                ${rec.studyMaterials.map(material => `<li>${material}</li>`).join('')}
                            </ul>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        // Close recommendations modal when clicking outside
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('recommendationsModal');
            if (modal && e.target === modal) {
                hideRecommendationsModal();
            }
        });
    </script>

    <!-- Service Worker Registration - Needed to serve cached videos -->
    <!-- <script src="scripts/registerSW.js"></script> -->
    
    <script type="module" src="scripts/script.js"></script>
    <script type="module" src="scripts/loadBadges.js"></script>
    <script type="module" src="scripts/2/modalHandler.js"></script>
    <script type="module" src="scripts/fetchProfileData.js"></script>
    <script type="module" src="./scripts/loadLeaderboard.js"></script>
    <script type="module" src="./scripts/lockLevels.js"></script>
    <script type="module" src="./scripts/lockStoryMode.js"></script>
    <script type="module" src="./scripts/progressBar.js"></script>
    <script src="./scripts/pwa-install.js"></script>
</body>
</html>